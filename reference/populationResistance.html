<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Identify clusters of populations least separated by landscape resistance — populationResistance • safeHavens</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Identify clusters of populations least separated by landscape resistance — populationResistance"><meta name="description" content="Creates a matrix, and supporting data structures, of a Isolation by Distance distances using a simplified framework.
Given a raster surface parameterizing resistance to movement (e.g., oceans, lakes, rivers, topographic roughness, or habitat suitability), this function calculates pairwise landscape resistance among populations and identifies clusters of populations that are least isolated from each other.
The function can internally build a resistance raster, but for performance across multiple species, it is recommended to provide pre-computed surfaces.
Resistance is treated as isotropic (no slope directionality).
Clustering is based on pairwise IBR distances and can be visualized or used to guide sampling schemes."><meta property="og:description" content="Creates a matrix, and supporting data structures, of a Isolation by Distance distances using a simplified framework.
Given a raster surface parameterizing resistance to movement (e.g., oceans, lakes, rivers, topographic roughness, or habitat suitability), this function calculates pairwise landscape resistance among populations and identifies clusters of populations that are least isolated from each other.
The function can internally build a resistance raster, but for performance across multiple species, it is recommended to provide pre-computed surfaces.
Resistance is treated as isotropic (no slope directionality).
Clustering is based on pairwise IBR distances and can be visualized or used to guide sampling schemes."><meta property="og:image" content="https://sagesteppe.github.io/safeHavens/logo.png"><!-- Google Search Console Verification --><meta name="google-site-verification" content="viUZcwXk_Fi5hsfdB7m6GgrFgGMJ-xVe1BcMTezGJII"><!-- JSON-LD Structured Data for AI Crawlers --><script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "SoftwareApplication",
  "name": "safeHavens",
  "applicationCategory": "Scientific Software",
  "operatingSystem": "Windows, macOS, Linux",
  "softwareVersion": "0.0.0.9000",
  "description": "R package providing seven sampling schemes for germplasm curators to prioritize field collection efforts for ex situ plant conservation, including species distribution modeling optimized for germplasm sampling.",
  "url": "https://sagesteppe.github.io/safeHavens/",
  "downloadUrl": "https://github.com/sagesteppe/safeHavens",
  "author": {
    "@type": "Person",
    "name": "Reed Benkendorf",
    "url": "https://github.com/sagesteppe"
  },
  "programmingLanguage": "R",
  "keywords": [
    "germplasm conservation",
    "ex situ conservation",
    "plant conservation",
    "sampling design",
    "species distribution model",
    "SDM",
    "biodiversity",
    "seed collection",
    "R package",
    "conservation biology"
  ],
  "inLanguage": "en-US",
  "offers": {
    "@type": "Offer",
    "price": "0",
    "priceCurrency": "USD"
  }
}
</script><!-- Additional SEO Meta Tags --><meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large"><meta name="keywords" content="germplasm conservation, ex situ conservation, plant conservation, sampling design, species distribution model, R package"><meta name="author" content="Reed Benkendorf"><link rel="canonical" href="https://sagesteppe.github.io/safeHavens/"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">safeHavens</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sagesteppe/safeHavens/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Identify clusters of populations least separated by landscape resistance</h1>
      <small class="dont-index">Source: <a href="https://github.com/sagesteppe/safeHavens/blob/main/R/populationResistance.R" class="external-link"><code>R/populationResistance.R</code></a></small>
      <div class="d-none name"><code>populationResistance.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Creates a matrix, and supporting data structures, of a Isolation by Distance distances using a simplified framework.
Given a raster surface parameterizing resistance to movement (e.g., oceans, lakes, rivers, topographic roughness, or habitat suitability), this function calculates pairwise landscape resistance among populations and identifies clusters of populations that are least isolated from each other.</p>
<p>The function can internally build a resistance raster, but for performance across multiple species, it is recommended to provide pre-computed surfaces.
Resistance is treated as isotropic (no slope directionality).
Clustering is based on pairwise IBR distances and can be visualized or used to guide sampling schemes.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">populationResistance</span><span class="op">(</span></span>
<span>  <span class="va">populations_sf</span>,</span>
<span>  <span class="va">base_raster</span>,</span>
<span>  buffer_dist <span class="op">=</span> <span class="fl">25000</span>,</span>
<span>  planar_proj <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_points <span class="op">=</span> <span class="fl">150</span>,</span>
<span>  resistance_surface <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  oceans <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lakes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rivers <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tri <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  habitat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  w_ocean <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  w_lakes <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  w_rivers <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  w_tri <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  w_habitat <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  graph_method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"complete"</span>, <span class="st">"delaunay"</span><span class="op">)</span>,</span>
<span>  ibr_method <span class="op">=</span> <span class="st">"leastcost"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-populations-sf">populations_sf<a class="anchor" aria-label="anchor" href="#arg-populations-sf"></a></dt>
<dd><p>sf/tibble/data.frame. Coordinates of populations to be clustered. Must contain POINT geometries.</p></dd>


<dt id="arg-base-raster">base_raster<a class="anchor" aria-label="anchor" href="#arg-base-raster"></a></dt>
<dd><p>SpatRaster. Base raster for the study area. Provides template geometry and resolution.</p></dd>


<dt id="arg-buffer-dist">buffer_dist<a class="anchor" aria-label="anchor" href="#arg-buffer-dist"></a></dt>
<dd><p>Numeric. Distance to buffer population points to assign likely occupied cells (optional; ignored if using <code>sample_population_cells</code> directly).</p></dd>


<dt id="arg-planar-proj">planar_proj<a class="anchor" aria-label="anchor" href="#arg-planar-proj"></a></dt>
<dd><p>Numeric. EPSG code used to project <code>populations_sf</code> for buffering operations.</p></dd>


<dt id="arg-n-points">n_points<a class="anchor" aria-label="anchor" href="#arg-n-points"></a></dt>
<dd><p>Numeric (defaults to 50). Number of points to sample for creating the surface. Increasing points drastically increases compute time.</p></dd>


<dt id="arg-resistance-surface">resistance_surface<a class="anchor" aria-label="anchor" href="#arg-resistance-surface"></a></dt>
<dd><p>SpatRaster. Optional pre-computed resistance raster. If provided, the raster-building arguments are ignored.</p></dd>


<dt id="arg-oceans">oceans<a class="anchor" aria-label="anchor" href="#arg-oceans"></a></dt>
<dd><p>SpatRaster. Binary (0/1) raster for ocean cells. Used to increase movement cost.</p></dd>


<dt id="arg-lakes">lakes<a class="anchor" aria-label="anchor" href="#arg-lakes"></a></dt>
<dd><p>SpatRaster. Binary (0/1) raster for lakes.</p></dd>


<dt id="arg-rivers">rivers<a class="anchor" aria-label="anchor" href="#arg-rivers"></a></dt>
<dd><p>SpatRaster. Binary (0/1) raster for rivers.</p></dd>


<dt id="arg-tri">tri<a class="anchor" aria-label="anchor" href="#arg-tri"></a></dt>
<dd><p>SpatRaster. Continuous raster of topographic roughness (TRI). Used to increase cost in mountainous terrain.</p></dd>


<dt id="arg-habitat">habitat<a class="anchor" aria-label="anchor" href="#arg-habitat"></a></dt>
<dd><p>SpatRaster. Continuous raster of habitat suitability. Low values increase cost.</p></dd>


<dt id="arg-w-ocean">w_ocean<a class="anchor" aria-label="anchor" href="#arg-w-ocean"></a></dt>
<dd><p>Numeric. Weight applied to oceans (default 2000).</p></dd>


<dt id="arg-w-lakes">w_lakes<a class="anchor" aria-label="anchor" href="#arg-w-lakes"></a></dt>
<dd><p>Numeric. Weight applied to lakes (default 200).</p></dd>


<dt id="arg-w-rivers">w_rivers<a class="anchor" aria-label="anchor" href="#arg-w-rivers"></a></dt>
<dd><p>Numeric. Weight applied to rivers (default 20).</p></dd>


<dt id="arg-w-tri">w_tri<a class="anchor" aria-label="anchor" href="#arg-w-tri"></a></dt>
<dd><p>Numeric. Weight applied to TRI (default 1).</p></dd>


<dt id="arg-w-habitat">w_habitat<a class="anchor" aria-label="anchor" href="#arg-w-habitat"></a></dt>
<dd><p>Numeric. Weight applied to habitat suitability (default 1).</p></dd>


<dt id="arg-graph-method">graph_method<a class="anchor" aria-label="anchor" href="#arg-graph-method"></a></dt>
<dd><p>Character. One of <code>"delaunay"</code> or <code>"complete"</code>. Defines the spatial graph connecting population points.
Delauney produces a sparser graph can deal with higher <code>n</code>, 'complete' is more computationally intensive and n &gt; 175 take considerable time.</p></dd>


<dt id="arg-ibr-method">ibr_method<a class="anchor" aria-label="anchor" href="#arg-ibr-method"></a></dt>
<dd><p>Character. Currently only <code>"leastcost"</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with the following elements:</p><dl><dt>resistance_raster</dt>
<dd><p>The parameterized resistance SpatRaster used for IBR calculations.</p></dd>

<dt>sampled_points</dt>
<dd><p>sf POINT object of population cells used for graph calculations.</p></dd>

<dt>spatial_graph</dt>
<dd><p>igraph object representing the population connectivity graph.</p></dd>

<dt>edge_list</dt>
<dd><p>Data.frame of graph edges used for IBR computation.</p></dd>

<dt>ibr_matrix</dt>
<dd><p>Symmetric numeric matrix of pairwise landscape resistance between populations.</p></dd>


</dl></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Prepare resistance raster once</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># this also can run internally in `population resistance`, </span></span></span>
<span class="r-in"><span><span class="co"># but for time sakes is best to prep ahead of time</span></span></span>
<span class="r-in"><span><span class="co"># especially if treating multiple species in the same domain. </span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="buildResistanceSurface.html">buildResistanceSurface</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  base_raster <span class="op">=</span> <span class="va">base_rast</span>,</span></span>
<span class="r-in"><span>  oceans <span class="op">=</span> <span class="va">ocean_r</span>,</span></span>
<span class="r-in"><span>  lakes <span class="op">=</span> <span class="va">lakes_r</span>,</span></span>
<span class="r-in"><span>  rivers <span class="op">=</span> <span class="va">rivers_r</span>,</span></span>
<span class="r-in"><span>  tri <span class="op">=</span> <span class="va">tri_r</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run population resistance clustering</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">populationResistance</span><span class="op">(</span></span></span>
<span class="r-in"><span>  populations_sf <span class="op">=</span> <span class="va">pops_sf</span>,</span></span>
<span class="r-in"><span>  base_raster <span class="op">=</span> <span class="va">base_rast</span>,</span></span>
<span class="r-in"><span>  resistance_surface <span class="op">=</span> <span class="va">res</span>,</span></span>
<span class="r-in"><span>  n_points <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>  graph_method <span class="op">=</span> <span class="st">"mst"</span>,</span></span>
<span class="r-in"><span>  ibr_method <span class="op">=</span> <span class="st">"leastcost"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Access the results</span></span></span>
<span class="r-in"><span><span class="va">ibr_matrix</span> <span class="op">&lt;-</span> <span class="va">out</span><span class="op">$</span><span class="va">ibr_matrix</span></span></span>
<span class="r-in"><span><span class="va">graph</span> <span class="op">&lt;-</span> <span class="va">out</span><span class="op">$</span><span class="va">spatial_graph</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Reed Benkendorf.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

