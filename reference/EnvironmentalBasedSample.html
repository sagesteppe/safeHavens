<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create environmental and spatial clusters for targeting collection areas — EnvironmentalBasedSample • safeHavens</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create environmental and spatial clusters for targeting collection areas — EnvironmentalBasedSample"><meta name="description" content="This function utilizes the output from an elastic net GLM model to create a weights matrix of
features relevant to a species distribution to identify clusters throughout its range while
incorporating the PCNM/MEM data and coordinates to implement some spatial contiguity."><meta property="og:description" content="This function utilizes the output from an elastic net GLM model to create a weights matrix of
features relevant to a species distribution to identify clusters throughout its range while
incorporating the PCNM/MEM data and coordinates to implement some spatial contiguity."><meta property="og:image" content="https://sagesteppe.github.io/safeHavens/logo.png"><!-- Google Search Console Verification --><meta name="google-site-verification" content="viUZcwXk_Fi5hsfdB7m6GgrFgGMJ-xVe1BcMTezGJII"><!-- JSON-LD Structured Data for AI Crawlers --><script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "SoftwareApplication",
  "name": "safeHavens",
  "applicationCategory": "Scientific Software",
  "operatingSystem": "Windows, macOS, Linux",
  "softwareVersion": "0.0.0.9000",
  "description": "R package providing seven sampling schemes for germplasm curators to prioritize field collection efforts for ex situ plant conservation, including species distribution modeling optimized for germplasm sampling.",
  "url": "https://sagesteppe.github.io/safeHavens/",
  "downloadUrl": "https://github.com/sagesteppe/safeHavens",
  "author": {
    "@type": "Person",
    "name": "Reed Benkendorf",
    "url": "https://github.com/sagesteppe"
  },
  "programmingLanguage": "R",
  "keywords": [
    "germplasm conservation",
    "ex situ conservation",
    "plant conservation",
    "sampling design",
    "species distribution model",
    "SDM",
    "biodiversity",
    "seed collection",
    "R package",
    "conservation biology"
  ],
  "inLanguage": "en-US",
  "offers": {
    "@type": "Offer",
    "price": "0",
    "priceCurrency": "USD"
  }
}
</script><!-- Additional SEO Meta Tags --><meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large"><meta name="keywords" content="germplasm conservation, ex situ conservation, plant conservation, sampling design, species distribution model, R package"><meta name="author" content="Reed Benkendorf"><link rel="canonical" href="https://sagesteppe.github.io/safeHavens/"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">safeHavens</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sagesteppe/safeHavens/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Create environmental and spatial clusters for targeting collection areas</h1>
      <small class="dont-index">Source: <a href="https://github.com/sagesteppe/safeHavens/blob/main/R/EnvironmentalBasedSample.R" class="external-link"><code>R/EnvironmentalBasedSample.R</code></a></small>
      <div class="d-none name"><code>EnvironmentalBasedSample.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function utilizes the output from an elastic net GLM model to create a weights matrix of
features relevant to a species distribution to identify clusters throughout its range while
incorporating the PCNM/MEM data and coordinates to implement some spatial contiguity.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">EnvironmentalBasedSample</span><span class="op">(</span></span>
<span>  <span class="va">pred_rescale</span>,</span>
<span>  <span class="va">f_rasts</span>,</span>
<span>  lyr <span class="op">=</span> <span class="st">"Supplemented"</span>,</span>
<span>  <span class="va">taxon</span>,</span>
<span>  path <span class="op">=</span> <span class="st">"."</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  fixedClusters <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n_pts <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  <span class="va">planar_proj</span>,</span>
<span>  coord_wt <span class="op">=</span> <span class="fl">2.5</span>,</span>
<span>  buffer_d <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  prop_split <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  write2disk <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-pred-rescale">pred_rescale<a class="anchor" aria-label="anchor" href="#arg-pred-rescale"></a></dt>
<dd><p>a rasterstack of predictor layers which have been rescaled to represent the beta coefficients from the elastic net (glmnet::glmnet) modelling process. See ?RescaleRasters for an implementation of this functionality.</p></dd>


<dt id="arg-f-rasts">f_rasts<a class="anchor" aria-label="anchor" href="#arg-f-rasts"></a></dt>
<dd><p>The rasters output from the SDM workflow.</p></dd>


<dt id="arg-lyr">lyr<a class="anchor" aria-label="anchor" href="#arg-lyr"></a></dt>
<dd><p>Character. The name of the layer you want to use for the analysis one of: 'Threshold', 'Clipped', or Supplemented'. If missing defaults to 'Supplemented'.</p></dd>


<dt id="arg-taxon">taxon<a class="anchor" aria-label="anchor" href="#arg-taxon"></a></dt>
<dd><p>Character. the name of the taxonomic entity for which the models were created. The final raster of clusters, the results from both KNN classifier trainings, and details of the clustering procedure (if fixedClusters=TRUE).</p></dd>


<dt id="arg-path">path<a class="anchor" aria-label="anchor" href="#arg-path"></a></dt>
<dd><p>a root path where each output data will be saved, use the same as in <code>WriteSDMresults</code>. Defaults to current working directory, check this with getwd().</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>Numeric. the number of clusters desired.</p></dd>


<dt id="arg-fixedclusters">fixedClusters<a class="anchor" aria-label="anchor" href="#arg-fixedclusters"></a></dt>
<dd><p>Boolean. Defaults to TRUE, which will create n clusters. If False then use NbClust::NbClust to determine the number of clusters.</p></dd>


<dt id="arg-n-pts">n_pts<a class="anchor" aria-label="anchor" href="#arg-n-pts"></a></dt>
<dd><p>Numeric. the number of points to use for generating the clusters, these will be randomly sampled within the mask area <code>mask</code>. Defaults to 500.</p></dd>


<dt id="arg-planar-proj">planar_proj<a class="anchor" aria-label="anchor" href="#arg-planar-proj"></a></dt>
<dd><p>Numeric, or character vector. An EPSG code, or a proj4 string, for a planar coordinate projection, in meters, for use with the function.
For species with very narrow ranges a UTM zone may be best (e.g. 32611 for WGS84 zone 11 north, or 29611 for NAD83 zone 11 north).
Otherwise a continental scale projection like 5070 See https://projectionwizard.org/ for more information on CRS.
The value is simply passed to sf::st_transform if you need to experiment.</p></dd>


<dt id="arg-coord-wt">coord_wt<a class="anchor" aria-label="anchor" href="#arg-coord-wt"></a></dt>
<dd><p>Numeric. The amount to weigh coordinates by for the distance matrix relative to the most important variable identified by elastic net regression.
Defaults to 2.5, setting at 1 would make this value equivalent to environmental and PCNM variables.
This metric increases the spatial contiguity of the clusters identified.</p></dd>


<dt id="arg-buffer-d">buffer_d<a class="anchor" aria-label="anchor" href="#arg-buffer-d"></a></dt>
<dd><p>Numeric. When using two-stage sampling to increase the sample size (number of points) for uncommon clusters, the distance to buffer the individual pts which are located in these cells for further possible sampling.
Defaults to 3 which allows for each an area encompassing around 45-50 raster cells nearby to possibly be sampled.
This is a reasonable default for coarsely gridded data (the most sensible grain type for this packages use cases), moderate resolution data (e.g. 250m-1km) may require higher values to find meaningful differences between the variables at these further locations.</p></dd>


<dt id="arg-prop-split">prop_split<a class="anchor" aria-label="anchor" href="#arg-prop-split"></a></dt>
<dd><p>Numeric. The proportion of records to be used for training the KNN classifier. Defaults to
0.8 to use 80% of records for training and 20% for the independent test sample.</p></dd>


<dt id="arg-write-disk">write2disk<a class="anchor" aria-label="anchor" href="#arg-write-disk"></a></dt>
<dd><p>Boolean. Whether to write results to disk or not. Defaults to FALSE.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further arguments passed to NbClust::NbClust for optimizing cluster numbers. Defaults to using method = 'complete', which will compare the results from 20 methods and select the cluster number most commonly generated by all of these algorithms.
We have min.nc set as a default of 5, to overcome having too few clusters to use (but this easily overwritten by supplying the argument minc.nc=2, to set it lower), and max.nc = 20 for congruence with many seed collection endeavors (overwritten by max.nc = 10 for example).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Writes four objects to disk, and returns one object to R session (optional).</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Reed Benkendorf.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

