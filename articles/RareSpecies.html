<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Rare Species Sampling Schema • safeHavens</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Rare Species Sampling Schema">
<meta name="description" content="Running an additional sampling scheme for rare species. ">
<meta property="og:description" content="Running an additional sampling scheme for rare species. ">
<meta property="og:image" content="https://sagesteppe.github.io/safeHavens/logo.png">
<!-- Google Search Console Verification --><meta name="google-site-verification" content="viUZcwXk_Fi5hsfdB7m6GgrFgGMJ-xVe1BcMTezGJII">
<!-- JSON-LD Structured Data for AI Crawlers --><script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "SoftwareApplication",
  "name": "safeHavens",
  "applicationCategory": "Scientific Software",
  "operatingSystem": "Windows, macOS, Linux",
  "softwareVersion": "0.0.0.9000",
  "description": "R package providing seven sampling schemes for germplasm curators to prioritize field collection efforts for ex situ plant conservation, including species distribution modeling optimized for germplasm sampling.",
  "url": "https://sagesteppe.github.io/safeHavens/",
  "downloadUrl": "https://github.com/sagesteppe/safeHavens",
  "author": {
    "@type": "Person",
    "name": "Reed Benkendorf",
    "url": "https://github.com/sagesteppe"
  },
  "programmingLanguage": "R",
  "keywords": [
    "germplasm conservation",
    "ex situ conservation",
    "plant conservation",
    "sampling design",
    "species distribution model",
    "SDM",
    "biodiversity",
    "seed collection",
    "R package",
    "conservation biology"
  ],
  "inLanguage": "en-US",
  "offers": {
    "@type": "Offer",
    "price": "0",
    "priceCurrency": "USD"
  }
}
</script><!-- Additional SEO Meta Tags --><meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large">
<meta name="keywords" content="germplasm conservation, ex situ conservation, plant conservation, sampling design, species distribution model, R package">
<meta name="author" content="Reed Benkendorf">
<link rel="canonical" href="https://sagesteppe.github.io/safeHavens/">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">safeHavens</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sagesteppe/safeHavens/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Rare Species Sampling Schema</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/sagesteppe/safeHavens/blob/main/vignettes/RareSpecies.Rmd" class="external-link"><code>vignettes/RareSpecies.Rmd</code></a></small>
      <div class="d-none name"><code>RareSpecies.Rmd</code></div>
    </div>

    
    
<p><code>safeHavens</code> offers only one function that operates
explictly on population level data.</p>
<div class="section level2">
<h2 id="prepare-data">prepare data<a class="anchor" aria-label="anchor" href="#prepare-data"></a>
</h2>
<p>Load the required packages.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sagesteppe.github.io/safeHavens/">safeHavens</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">99</span><span class="op">)</span></span></code></pre></div>
<p>We will use the Bradypus data included in the <code>dismo</code>
package for this vignette.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package<span class="op">=</span><span class="st">"dismo"</span><span class="op">)</span>, <span class="st">'ex'</span>, <span class="st">'bradypus.csv'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'lon'</span>, <span class="st">'lat'</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">x</span>, coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'lon'</span>, <span class="st">'lat'</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span></span></code></pre></div>
<p>And we will create the same base map used in
<code>GettingStarted</code>, note this chunk is ‘hidden’ in the rendered
man pages, but present in the raw vignette documents.</p>
<pre><code>Warning: attribute variables are assumed to be spatially constant throughout
all geometries</code></pre>
<p>While all other functions in the package handle <code>sf</code>
objects directly, this function will actually just use a simple
data.frame of sites, to streamline making a couple calculations.</p>
<p>The input to the <code>KMedoidsBasedSample</code> function is a list
with two elements: a distance matrix, and a data frame of site locations
and attributes. The data frame must contain the following columns.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>n_sites <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x) </span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  <span class="at">site_id =</span> <span class="fu">seq_len</span>(n_sites),</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  <span class="at">required =</span> <span class="cn">FALSE</span>,</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  <span class="at">coord_uncertainty =</span> <span class="dv">0</span>, </span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>  <span class="at">lon =</span> sf<span class="sc">::</span><span class="fu">st_coordinates</span>(x)[,<span class="dv">1</span>], </span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>  <span class="at">lat =</span> sf<span class="sc">::</span><span class="fu">st_coordinates</span>(x)[,<span class="dv">2</span>]</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>)</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="fu">head</span>(df)</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>  site_id required coord_uncertainty      lon      lat</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="dv">1</span>       <span class="dv">1</span>    <span class="cn">FALSE</span>                 <span class="dv">0</span> <span class="sc">-</span><span class="fl">65.4000</span> <span class="sc">-</span><span class="fl">10.3833</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="dv">2</span>       <span class="dv">2</span>    <span class="cn">FALSE</span>                 <span class="dv">0</span> <span class="sc">-</span><span class="fl">65.3833</span> <span class="sc">-</span><span class="fl">10.3833</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="dv">3</span>       <span class="dv">3</span>    <span class="cn">FALSE</span>                 <span class="dv">0</span> <span class="sc">-</span><span class="fl">65.1333</span> <span class="sc">-</span><span class="fl">16.8000</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="dv">4</span>       <span class="dv">4</span>    <span class="cn">FALSE</span>                 <span class="dv">0</span> <span class="sc">-</span><span class="fl">63.6667</span> <span class="sc">-</span><span class="fl">17.4500</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="dv">5</span>       <span class="dv">5</span>    <span class="cn">FALSE</span>                 <span class="dv">0</span> <span class="sc">-</span><span class="fl">63.8500</span> <span class="sc">-</span><span class="fl">17.4000</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="dv">6</span>       <span class="dv">6</span>    <span class="cn">FALSE</span>                 <span class="dv">0</span> <span class="sc">-</span><span class="fl">64.4167</span> <span class="sc">-</span><span class="fl">16.0000</span></span></code></pre></div>
<p>The second required element, the distance matrix, can be calculated
with the <code>greatCircleDistance</code> function in the package.
Please use this rather than <code>st_distance</code> from
<code>sf</code> for consistency, as the units differ slightly. If you
want to use <code><a href="https://r-spatial.github.io/sf/reference/geos_measures.html" class="external-link">sf::st_distance</a></code>, make sure to convert the units
to match the scale of the <code>greatCircleDistance</code> function,
otherwise the results will be incorrect. Note that you can also use an
environmental distance matrix from the first two axes of a PCA, this is
detailed below.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dist_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>   <span class="fu"><a href="../reference/greatCircleDistance.html">greatCircleDistance</a></span><span class="op">(</span></span>
<span>     <span class="va">df</span><span class="op">$</span><span class="va">lat</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">df</span><span class="op">$</span><span class="va">lon</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>     <span class="va">df</span><span class="op">$</span><span class="va">lat</span>, <span class="va">df</span><span class="op">$</span><span class="va">lon</span></span>
<span>   <span class="op">)</span></span>
<span> <span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>The optimization routine requires at least one ‘required’ site to be
specified. Here we will select the site closest to the geographic center
of all sites as the required site.</p>
<p>Normally this can refer to existing accessions, or administrative
units, or nature preserves which are helping to implement the germplasm
collection, and are fortunate enough to already have some samples or at
least guaranteed access.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dists2c</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/greatCircleDistance.html">greatCircleDistance</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rspatial.github.io/terra/reference/summarize-generics.html" class="external-link">median</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">lat</span><span class="op">)</span>, </span>
<span>  <span class="fu"><a href="https://rspatial.github.io/terra/reference/summarize-generics.html" class="external-link">median</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">lon</span><span class="op">)</span>, </span>
<span>  <span class="va">df</span><span class="op">$</span><span class="va">lat</span>, </span>
<span>  <span class="va">df</span><span class="op">$</span><span class="va">lon</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">dists2c</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="st">'required'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span></code></pre></div>
<p>This function not only bootstraps sites to simulate the true
distribution of the species, but it also bootstraps coordinate
uncertainty for each site. Here we will randomly assign 20% of the sites
to have coordinate uncertainty between 1 km and 40 km. Note that he
argument is always in meters.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">uncertain_sites</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n_sites</span><span class="op">)</span>, </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">required</span><span class="op">)</span><span class="op">)</span>, </span>
<span>  size <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="va">n_sites</span><span class="op">*</span><span class="fl">0.2</span>, <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">coord_uncertainty</span><span class="op">[</span><span class="va">uncertain_sites</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">uncertain_sites</span><span class="op">)</span>, <span class="fl">1000</span>, <span class="fl">40000</span><span class="op">)</span> <span class="co"># meters</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="run-kmedoidsbasedsample-based-only-on-geographic-distances">Run KMedoidsBasedSample based only on geographic distances<a class="anchor" aria-label="anchor" href="#run-kmedoidsbasedsample-based-only-on-geographic-distances"></a>
</h2>
<p>The input to the function is the distance matrix, and the site
data.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>  <span class="at">distances =</span> dist_mat,</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>  <span class="at">sites =</span> df</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>  )</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="fu">str</span>(test_data)</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>List of <span class="dv">2</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a> <span class="sc">$</span> distances<span class="sc">:</span> num [<span class="dv">1</span><span class="sc">:</span><span class="dv">116</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">116</span>] <span class="dv">0</span> <span class="fl">1.83</span> <span class="fl">714.09</span> <span class="fl">807.71</span> <span class="fl">797.93</span> ...</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a> <span class="sc">$</span> sites    <span class="sc">:</span><span class="st">'data.frame'</span><span class="sc">:</span>  <span class="dv">116</span> obs. of  <span class="dv">5</span> variables<span class="sc">:</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>  ..<span class="sc">$</span> site_id          <span class="sc">:</span> int [<span class="dv">1</span><span class="sc">:</span><span class="dv">116</span>] <span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">7</span> <span class="dv">8</span> <span class="dv">9</span> <span class="dv">10</span> ...</span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>  ..<span class="sc">$</span> required         <span class="sc">:</span> logi [<span class="dv">1</span><span class="sc">:</span><span class="dv">116</span>] <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> ...</span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>  ..<span class="sc">$</span> coord_uncertainty<span class="sc">:</span> num [<span class="dv">1</span><span class="sc">:</span><span class="dv">116</span>] <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> ...</span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a>  ..<span class="sc">$</span> lon              <span class="sc">:</span> num [<span class="dv">1</span><span class="sc">:</span><span class="dv">116</span>] <span class="sc">-</span><span class="fl">65.4</span> <span class="sc">-</span><span class="fl">65.4</span> <span class="sc">-</span><span class="fl">65.1</span> <span class="sc">-</span><span class="fl">63.7</span> <span class="sc">-</span><span class="fl">63.9</span> ...</span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a>  ..<span class="sc">$</span> lat              <span class="sc">:</span> num [<span class="dv">1</span><span class="sc">:</span><span class="dv">116</span>] <span class="sc">-</span><span class="fl">10.4</span> <span class="sc">-</span><span class="fl">10.4</span> <span class="sc">-</span><span class="fl">16.8</span> <span class="sc">-</span><span class="fl">17.4</span> <span class="sc">-</span><span class="fl">17.4</span> ...</span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="fu">rm</span>(x, n_sites, uncertain_sites, dists2c)</span></code></pre></div>
<p>The funtion <code>KMedoidsBasedSample</code> has several arguments
used to control run parameters.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>st <span class="ot">&lt;-</span> <span class="fu">system.time</span>( {</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>    geo_res <span class="ot">&lt;-</span> <span class="fu">KMedoidsBasedSample</span>(  <span class="do">## reduce some parameters for faster run. </span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>      <span class="at">input_data =</span> test_data,</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>      <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>      <span class="at">n_bootstrap =</span> <span class="dv">10</span>,</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>      <span class="at">dropout_prob =</span> <span class="fl">0.1</span>,</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>      <span class="at">n_local_search_iter =</span> <span class="dv">10</span>,</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>      <span class="at">n_restarts =</span> <span class="dv">2</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>    )</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>  }</span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>)</span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>Sites<span class="sc">:</span> <span class="dv">116</span> <span class="sc">|</span> Seeds<span class="sc">:</span> <span class="dv">1</span> <span class="sc">|</span> Requested<span class="sc">:</span> <span class="dv">5</span> <span class="sc">|</span> Coord. Uncertain<span class="sc">:</span> <span class="dv">19</span> <span class="sc">|</span> BS Replicates<span class="sc">:</span> <span class="dv">10</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>  <span class="sc">|</span>                                                                              <span class="er">|</span>                                                                      <span class="er">|</span>   <span class="dv">0</span><span class="sc">%  |                                                                              |=======                                                               |  10%</span>  <span class="er">|</span>                                                                              <span class="er">|==============</span>                                                        <span class="er">|</span>  <span class="dv">20</span><span class="sc">%  |                                                                              |=====================                                                 |  30%</span>  <span class="er">|</span>                                                                              <span class="er">|============================</span>                                          <span class="er">|</span>  <span class="dv">40</span><span class="sc">%  |                                                                              |===================================                                   |  50%</span>  <span class="er">|</span>                                                                              <span class="er">|==========================================</span>                            <span class="er">|</span>  <span class="dv">60</span><span class="sc">%  |                                                                              |=================================================                     |  70%</span>  <span class="er">|</span>                                                                              <span class="er">|========================================================</span>              <span class="er">|</span>  <span class="dv">80</span><span class="sc">%  |                                                                              |===============================================================       |  90%</span>  <span class="er">|</span>                                                                              <span class="er">|======================================================================|</span> <span class="dv">100</span>%</span></code></pre></div>
<p>The function operates relatively quick with few bootstraps and few
sites, but will take a smidge of time longer with more complex
scenarios. We recommened using at least 999 bootstraps for real world
applications.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>st</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>   user  system elapsed </span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a> <span class="fl">26.572</span>   <span class="fl">0.024</span>  <span class="fl">26.598</span> </span></code></pre></div>
<div class="section level3">
<h3 id="return-output-structure">return output structure<a class="anchor" aria-label="anchor" href="#return-output-structure"></a>
</h3>
<p>Five objects are returned by the function.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">str</span>(geo_res)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>List of <span class="dv">5</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a> <span class="sc">$</span> input_data     <span class="sc">:</span><span class="st">'data.frame'</span><span class="sc">:</span>    <span class="dv">116</span> obs. of  <span class="dv">10</span> variables<span class="sc">:</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  ..<span class="sc">$</span> site_id          <span class="sc">:</span> int [<span class="dv">1</span><span class="sc">:</span><span class="dv">116</span>] <span class="dv">47</span> <span class="dv">21</span> <span class="dv">5</span> <span class="dv">83</span> <span class="dv">100</span> <span class="dv">6</span> <span class="dv">106</span> <span class="dv">19</span> <span class="dv">95</span> <span class="dv">86</span> ...</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>  ..<span class="sc">$</span> required         <span class="sc">:</span> logi [<span class="dv">1</span><span class="sc">:</span><span class="dv">116</span>] <span class="cn">TRUE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> ...</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>  ..<span class="sc">$</span> coord_uncertainty<span class="sc">:</span> num [<span class="dv">1</span><span class="sc">:</span><span class="dv">116</span>] <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">37284</span> <span class="dv">13617</span> ...</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>  ..<span class="sc">$</span> lon              <span class="sc">:</span> num [<span class="dv">1</span><span class="sc">:</span><span class="dv">116</span>] <span class="sc">-</span><span class="fl">74.3</span> <span class="sc">-</span><span class="fl">55.1</span> <span class="sc">-</span><span class="fl">63.9</span> <span class="sc">-</span><span class="fl">79.8</span> <span class="sc">-</span><span class="fl">74.1</span> ...</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>  ..<span class="sc">$</span> lat              <span class="sc">:</span> num [<span class="dv">1</span><span class="sc">:</span><span class="dv">116</span>] <span class="fl">4.58</span> <span class="sc">-</span><span class="fl">2.83</span> <span class="sc">-</span><span class="fl">17.4</span> <span class="fl">9.17</span> <span class="sc">-</span><span class="fl">2.37</span> ...</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>  ..<span class="sc">$</span> certain          <span class="sc">:</span> logi [<span class="dv">1</span><span class="sc">:</span><span class="dv">116</span>] <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> ...</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>  ..<span class="sc">$</span> cooccur_strength <span class="sc">:</span> num [<span class="dv">1</span><span class="sc">:</span><span class="dv">116</span>] <span class="dv">40</span> <span class="dv">28</span> <span class="dv">24</span> <span class="dv">20</span> <span class="dv">20</span> <span class="dv">16</span> <span class="dv">16</span> <span class="dv">12</span> <span class="dv">12</span> <span class="dv">8</span> ...</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>  ..<span class="sc">$</span> is_seed          <span class="sc">:</span> logi [<span class="dv">1</span><span class="sc">:</span><span class="dv">116</span>] <span class="cn">TRUE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> ...</span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>  ..<span class="sc">$</span> selected         <span class="sc">:</span> logi [<span class="dv">1</span><span class="sc">:</span><span class="dv">116</span>] <span class="cn">TRUE</span> <span class="cn">TRUE</span> <span class="cn">FALSE</span> <span class="cn">TRUE</span> <span class="cn">FALSE</span> <span class="cn">TRUE</span> ...</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>  ..<span class="sc">$</span> sample_rank      <span class="sc">:</span> int [<span class="dv">1</span><span class="sc">:</span><span class="dv">116</span>] <span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">4</span> <span class="dv">5</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">6</span> <span class="dv">7</span> ...</span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a> <span class="sc">$</span> selected_sites <span class="sc">:</span> int [<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>] <span class="dv">6</span> <span class="dv">21</span> <span class="dv">47</span> <span class="dv">83</span> <span class="dv">106</span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a> <span class="sc">$</span> stability_score<span class="sc">:</span> num <span class="fl">0.2</span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a> <span class="sc">$</span> stability      <span class="sc">:</span><span class="st">'data.frame'</span><span class="sc">:</span>    <span class="dv">116</span> obs. of  <span class="dv">3</span> variables<span class="sc">:</span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a>  ..<span class="sc">$</span> site_id         <span class="sc">:</span> int [<span class="dv">1</span><span class="sc">:</span><span class="dv">116</span>] <span class="dv">47</span> <span class="dv">21</span> <span class="dv">5</span> <span class="dv">83</span> <span class="dv">100</span> <span class="dv">6</span> <span class="dv">106</span> <span class="dv">19</span> <span class="dv">95</span> <span class="dv">86</span> ...</span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a>  ..<span class="sc">$</span> cooccur_strength<span class="sc">:</span> num [<span class="dv">1</span><span class="sc">:</span><span class="dv">116</span>] <span class="dv">40</span> <span class="dv">28</span> <span class="dv">24</span> <span class="dv">20</span> <span class="dv">20</span> <span class="dv">16</span> <span class="dv">16</span> <span class="dv">12</span> <span class="dv">12</span> <span class="dv">8</span> ...</span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a>  ..<span class="sc">$</span> is_seed         <span class="sc">:</span> logi [<span class="dv">1</span><span class="sc">:</span><span class="dv">116</span>] <span class="cn">TRUE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> ...</span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a> <span class="sc">$</span> settings       <span class="sc">:</span><span class="st">'data.frame'</span><span class="sc">:</span>    <span class="dv">1</span> obs. of  <span class="dv">4</span> variables<span class="sc">:</span></span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a>  ..<span class="sc">$</span> n_sites     <span class="sc">:</span> num <span class="dv">5</span></span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a>  ..<span class="sc">$</span> n_bootstrap <span class="sc">:</span> num <span class="dv">10</span></span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a>  ..<span class="sc">$</span> dropout_prob<span class="sc">:</span> num <span class="fl">0.1</span></span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a>  ..<span class="sc">$</span> n_uncertain <span class="sc">:</span> int <span class="dv">19</span></span></code></pre></div>
<p>The stability score shows how often the most frquently selected
network of sites was selected from the bootstrapped runs.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">head</span>(geo_res<span class="sc">$</span>stability_score)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.2</span></span></code></pre></div>
<p>The stability data frame shows how often each site was selected
across all bootstrap runs.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">head</span>(geo_res<span class="sc">$</span>stability)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>    site_id cooccur_strength is_seed</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="dv">47</span>       <span class="dv">47</span>               <span class="dv">40</span>    <span class="cn">TRUE</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="dv">21</span>       <span class="dv">21</span>               <span class="dv">28</span>   <span class="cn">FALSE</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="dv">5</span>         <span class="dv">5</span>               <span class="dv">24</span>   <span class="cn">FALSE</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="dv">83</span>       <span class="dv">83</span>               <span class="dv">20</span>   <span class="cn">FALSE</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="dv">100</span>     <span class="dv">100</span>               <span class="dv">20</span>   <span class="cn">FALSE</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="dv">6</span>         <span class="dv">6</span>               <span class="dv">16</span>   <span class="cn">FALSE</span></span></code></pre></div>
<p>Many users may find the combindation of their input data with a few
columns, to be all they need to carry on after the results.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">head</span>(geo_res<span class="sc">$</span>input_data)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>    site_id required coord_uncertainty      lon      lat certain</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="dv">47</span>       <span class="dv">47</span>     <span class="cn">TRUE</span>              <span class="fl">0.00</span> <span class="sc">-</span><span class="fl">74.3000</span>   <span class="fl">4.5833</span>   <span class="cn">FALSE</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="dv">21</span>       <span class="dv">21</span>    <span class="cn">FALSE</span>              <span class="fl">0.00</span> <span class="sc">-</span><span class="fl">55.1333</span>  <span class="sc">-</span><span class="fl">2.8333</span>   <span class="cn">FALSE</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="dv">5</span>         <span class="dv">5</span>    <span class="cn">FALSE</span>              <span class="fl">0.00</span> <span class="sc">-</span><span class="fl">63.8500</span> <span class="sc">-</span><span class="fl">17.4000</span>   <span class="cn">FALSE</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="dv">83</span>       <span class="dv">83</span>    <span class="cn">FALSE</span>          <span class="fl">37283.66</span> <span class="sc">-</span><span class="fl">79.8167</span>   <span class="fl">9.1667</span>   <span class="cn">FALSE</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="dv">100</span>     <span class="dv">100</span>    <span class="cn">FALSE</span>          <span class="fl">13616.63</span> <span class="sc">-</span><span class="fl">74.0833</span>  <span class="sc">-</span><span class="fl">2.3667</span>   <span class="cn">FALSE</span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="dv">6</span>         <span class="dv">6</span>    <span class="cn">FALSE</span>              <span class="fl">0.00</span> <span class="sc">-</span><span class="fl">64.4167</span> <span class="sc">-</span><span class="fl">16.0000</span>   <span class="cn">FALSE</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>    cooccur_strength is_seed selected sample_rank</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="dv">47</span>                <span class="dv">40</span>    <span class="cn">TRUE</span>     <span class="cn">TRUE</span>           <span class="dv">1</span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="dv">21</span>                <span class="dv">28</span>   <span class="cn">FALSE</span>     <span class="cn">TRUE</span>           <span class="dv">2</span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="dv">5</span>                 <span class="dv">24</span>   <span class="cn">FALSE</span>    <span class="cn">FALSE</span>           <span class="dv">3</span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a><span class="dv">83</span>                <span class="dv">20</span>   <span class="cn">FALSE</span>     <span class="cn">TRUE</span>           <span class="dv">4</span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a><span class="dv">100</span>               <span class="dv">20</span>   <span class="cn">FALSE</span>    <span class="cn">FALSE</span>           <span class="dv">4</span></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a><span class="dv">6</span>                 <span class="dv">16</span>   <span class="cn">FALSE</span>     <span class="cn">TRUE</span>           <span class="dv">5</span></span></code></pre></div>
<p>Run parameters are saved in the settings element.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">head</span>(geo_res<span class="sc">$</span>settings)</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>  n_sites n_bootstrap dropout_prob n_uncertain</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="dv">1</span>       <span class="dv">5</span>          <span class="dv">10</span>          <span class="fl">0.1</span>          <span class="dv">19</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualize-the-selection-results">visualize the selection results<a class="anchor" aria-label="anchor" href="#visualize-the-selection-results"></a>
</h3>
<p>We can plot the required, and selected sites.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">map</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">geo_res</span><span class="op">$</span><span class="va">input_data</span>, </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">lon</span>, </span>
<span>    y <span class="op">=</span> <span class="va">lat</span>, </span>
<span>    shape <span class="op">=</span> <span class="va">required</span>, </span>
<span>    size <span class="op">=</span> <span class="va">cooccur_strength</span>,</span>
<span>    color <span class="op">=</span> <span class="va">selected</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span> <span class="co"># ggrepel::geom_label_repel(aes(label = site_id), size = 4) + </span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">'Priority Selection Status of Sites; Geographic Distances'</span><span class="op">)</span></span></code></pre></div>
<p><img src="RareSpecies_files/figure-html/first%20selection%20of%20target%20sites-1.png" class="r-plt" alt="" width="700"></p>
<p>As you can see, a couple alternative sites in very close proximity to
the selected sites also score highly. Functionally, these could serve as
subtitutes for the target sites. What is important is that these
combinations are found and articulated in the results.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">map</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">geo_res</span><span class="op">$</span><span class="va">input_data</span>, </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">lon</span>, </span>
<span>      y <span class="op">=</span> <span class="va">lat</span>, </span>
<span>      shape <span class="op">=</span> <span class="va">required</span>, </span>
<span>      size <span class="op">=</span> <span class="op">-</span><span class="va">sample_rank</span>,</span>
<span>      color <span class="op">=</span> <span class="va">sample_rank</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span> <span class="co"># ggrepel::geom_label_repel(aes(label = sample_rank), size = 4) +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span>   </span></code></pre></div>
<p><img src="RareSpecies_files/figure-html/priority%20ranking%20plot-1.png" class="r-plt" alt="" width="700"></p>
<p>Because we believe that as many populations should be sampled as
<em>can</em> be sampled, we include a ‘priority’ ranking with the
results. Focus should be on the selected sites, but opportunities to
sample beyond these should not be overlooked.</p>
</div>
</div>
<div class="section level2">
<h2 id="run-kmedoidsbasedsample-with-environmental-distances">run KMedoidsBasedSample with environmental distances<a class="anchor" aria-label="anchor" href="#run-kmedoidsbasedsample-with-environmental-distances"></a>
</h2>
<p>As mentioned, instead of using geographic distance, we can use
environmental distance ordinated into two dimensional space. An analyst
should only consider the use of variables they know relevant to the
species distrubution for this. However, for the sake of the example we
will feed in the full stack of environmental variables available from
the dismo package.</p>
<div class="section level3">
<h3 id="extract-prep-environmental-distances">extract prep environmental distances<a class="anchor" aria-label="anchor" href="#extract-prep-environmental-distances"></a>
</h3>
<p>First we read in the rasters.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span></span>
<span>  path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package<span class="op">=</span><span class="st">"dismo"</span><span class="op">)</span>, <span class="st">'ex'</span><span class="op">)</span>, </span>
<span>  pattern <span class="op">=</span> <span class="st">'grd'</span>,  full.names<span class="op">=</span><span class="cn">TRUE</span> <span class="op">)</span></span>
<span><span class="va">predictors</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">files</span><span class="op">)</span> <span class="co"># import the independent variables</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">files</span><span class="op">)</span></span></code></pre></div>
<p>For our environmental distances, we will use a PCA transformation of
the environmental variables. We will sample 100 random points from the
raster layers to calculate the PCA, and then predict the PCA raster
layers across the entire study area. We will take the only the first two
layers, from the pca, and calculate environmental distances based on
these two layers.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>pts <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">spatSample</span>(predictors, <span class="dv">100</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>pts <span class="ot">&lt;-</span> pts[, <span class="fu">names</span>(pts)<span class="sc">!=</span><span class="st">'biome'</span> ] <span class="co"># remove categorical variable for distance calc</span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>pca_results <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">prcomp</span>(pts, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="fu">round</span>(pca_results<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">sum</span>(pca_results<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span>), <span class="dv">2</span>) <span class="co"># variance explained</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.58</span> <span class="fl">0.26</span> <span class="fl">0.10</span> <span class="fl">0.04</span> <span class="fl">0.02</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.00</span></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>pca_raster <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">predict</span>(predictors, pca_results)</span></code></pre></div>
<p>From the above we see that the first two PCA axes explain a large
amount of the variance observed in this landscape.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">pca_raster</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># prediction of the pca onto a new raster</span></span></code></pre></div>
<p><img src="RareSpecies_files/figure-html/plot%20pca%20layers-1.png" class="r-plt" alt="" width="700"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">pts</span>, <span class="va">predictors</span>, <span class="va">pca_results</span><span class="op">)</span></span></code></pre></div>
<p>We keep the first two PCA layers for environmental distance
calculation. More layers will increase dimensionality, and may lead to
less useful results. Note that it’s fine to use a euclidean distance
calculation for these, as the values are truly in the position of the
pca plot.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">env_values</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/extract.html" class="external-link">extract</a></span><span class="op">(</span><span class="va">pca_raster</span>, </span>
<span>  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html" class="external-link">st_coordinates</a></span><span class="op">(</span></span>
<span>    <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span></span>
<span>      <span class="va">df</span>, </span>
<span>      coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'lon'</span>, <span class="st">'lat'</span><span class="op">)</span>, </span>
<span>      crs <span class="op">=</span> <span class="fl">4326</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">env_values</span>, main <span class="op">=</span> <span class="st">'environmental distance of points from first two PCA axis'</span><span class="op">)</span></span></code></pre></div>
<p><img src="RareSpecies_files/figure-html/extract%20environmental%20values%20and%20calculate%20distance%20matrix-1.png" class="r-plt" alt="" width="700"></p>
<p>We’ll ensure that these data are in a proper matrix format for
feeding into the function.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">env_dist_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/coerce.html" class="external-link">as.matrix</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">env_values</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">pca_raster</span><span class="op">)</span></span></code></pre></div>
<p>Similar to the above run with geographic distances, we create our
input object, and run the function.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>  <span class="at">distances =</span> env_dist_mat,</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>  <span class="at">sites =</span> df</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>  )</span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>st <span class="ot">&lt;-</span> <span class="fu">system.time</span>( </span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a>  {</span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a>    env_res <span class="ot">&lt;-</span> <span class="fu">KMedoidsBasedSample</span>(  <span class="do">## reduce some parameters for shorter run time.</span></span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a>      <span class="at">input_data =</span> test_data,</span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a>      <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb24-11"><a href="#cb24-11" tabindex="-1"></a>      <span class="at">n_bootstrap =</span> <span class="dv">10</span>,</span>
<span id="cb24-12"><a href="#cb24-12" tabindex="-1"></a>      <span class="at">dropout_prob =</span> <span class="fl">0.1</span>,</span>
<span id="cb24-13"><a href="#cb24-13" tabindex="-1"></a>      <span class="at">n_local_search_iter =</span> <span class="dv">50</span>,</span>
<span id="cb24-14"><a href="#cb24-14" tabindex="-1"></a>      <span class="at">n_restarts =</span> <span class="dv">2</span></span>
<span id="cb24-15"><a href="#cb24-15" tabindex="-1"></a>    )</span>
<span id="cb24-16"><a href="#cb24-16" tabindex="-1"></a>  }</span>
<span id="cb24-17"><a href="#cb24-17" tabindex="-1"></a>)</span>
<span id="cb24-18"><a href="#cb24-18" tabindex="-1"></a>Sites<span class="sc">:</span> <span class="dv">116</span> <span class="sc">|</span> Seeds<span class="sc">:</span> <span class="dv">1</span> <span class="sc">|</span> Requested<span class="sc">:</span> <span class="dv">5</span> <span class="sc">|</span> Coord. Uncertain<span class="sc">:</span> <span class="dv">19</span> <span class="sc">|</span> BS Replicates<span class="sc">:</span> <span class="dv">10</span></span>
<span id="cb24-19"><a href="#cb24-19" tabindex="-1"></a>  <span class="sc">|</span>                                                                              <span class="er">|</span>                                                                      <span class="er">|</span>   <span class="dv">0</span><span class="sc">%  |                                                                              |=======                                                               |  10%</span>  <span class="er">|</span>                                                                              <span class="er">|==============</span>                                                        <span class="er">|</span>  <span class="dv">20</span><span class="sc">%  |                                                                              |=====================                                                 |  30%</span>  <span class="er">|</span>                                                                              <span class="er">|============================</span>                                          <span class="er">|</span>  <span class="dv">40</span><span class="sc">%  |                                                                              |===================================                                   |  50%</span>  <span class="er">|</span>                                                                              <span class="er">|==========================================</span>                            <span class="er">|</span>  <span class="dv">60</span><span class="sc">%  |                                                                              |=================================================                     |  70%</span>  <span class="er">|</span>                                                                              <span class="er">|========================================================</span>              <span class="er">|</span>  <span class="dv">80</span><span class="sc">%  |                                                                              |===============================================================       |  90%</span>  <span class="er">|</span>                                                                              <span class="er">|======================================================================|</span> <span class="dv">100</span>%</span>
<span id="cb24-20"><a href="#cb24-20" tabindex="-1"></a></span>
<span id="cb24-21"><a href="#cb24-21" tabindex="-1"></a><span class="fu">rm</span>(dist_mat, env_dist_mat)</span></code></pre></div>
<p>This run takes longer than the runs with only the geographic distance
matrix.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>st</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>   user  system elapsed </span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a> <span class="fl">34.427</span>   <span class="fl">0.020</span>  <span class="fl">34.449</span> </span></code></pre></div>
<p>The environmental distance run takes about 10 seconds longer.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="fu">head</span>(env_res<span class="sc">$</span>stability_score)</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.2</span></span></code></pre></div>
<p>The overall stability score is similar to from the geographic score.
When you view the plots you will see that a handful of sites in close
proximity to the selected sites would have served as nearly equivanently
suitable substitutes. A few areas have dropped out of priority sampling
based on this method, but in general the results are pretty similar -
the relationship between geographic and environmental distance is
somewhat strong in this landscape.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">map</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">env_res</span><span class="op">$</span><span class="va">input_data</span>, </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">lon</span>, </span>
<span>      y <span class="op">=</span> <span class="va">lat</span>, </span>
<span>      shape <span class="op">=</span> <span class="va">required</span>, </span>
<span>      size <span class="op">=</span> <span class="va">cooccur_strength</span>,</span>
<span>      color <span class="op">=</span> <span class="va">selected</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span> <span class="co"># ggrepel::geom_label_repel(aes(label = site_id), size = 4) + </span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">'Priority Selection Status of Sites; Environmental'</span><span class="op">)</span></span></code></pre></div>
<p><img src="RareSpecies_files/figure-html/unnamed-chunk-10-1.png" class="r-plt" alt="" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="alternative-methods-for-required-central-points">alternative methods for required central points<a class="anchor" aria-label="anchor" href="#alternative-methods-for-required-central-points"></a>
</h2>
<p>In the example above we use a point at the median geographic center
of the populations.</p>
<p>We can also identify the population which is <em>most</em> near the
highest density of populations. Intuitively, this would be suggested as
a population with a high amount of genetic diversity for the species,
although it is unlikely to have accumulated considerably local changes
as the effects of drift are overcome by more frequent dispersal.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dens</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/kde2d.html" class="external-link">kde2d</a></span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span>, n <span class="op">=</span> <span class="fl">200</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">max_idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">dens</span><span class="op">$</span><span class="va">z</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">dens</span><span class="op">$</span><span class="va">z</span><span class="op">)</span>, arr.ind <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="va">max_point</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">dens</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="va">max_idx</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">dens</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="va">max_idx</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pops_centre</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sweep.html" class="external-link">sweep</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'lon'</span>, <span class="st">'lat'</span><span class="op">)</span><span class="op">]</span>, <span class="fl">2</span>, <span class="va">max_point</span>, <span class="st">"-"</span><span class="op">)</span></span>
<span><span class="va">pop_centered_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/summarize-generics.html" class="external-link">which.min</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rowSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">pops_centre</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">dens</span>, <span class="va">max_idx</span>, <span class="va">max_point</span>, <span class="va">pops_centre</span><span class="op">)</span></span></code></pre></div>
<p>Alternatively we can identify the <em>population</em> which is most
near the ‘center’ of the environmental variable space.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">env_centered</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sweep.html" class="external-link">sweep</a></span><span class="op">(</span><span class="va">env_values</span>, <span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">env_values</span>, <span class="va">median</span><span class="op">)</span>, <span class="st">"-"</span><span class="op">)</span></span>
<span><span class="va">env_centered_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/summarize-generics.html" class="external-link">which.min</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rowSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">env_centered</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">env_values</span><span class="op">)</span></span></code></pre></div>
<p>Personally I would consider the ‘pop centered’ population to be the
most important required site to center a design off of. However, it can
suffer from sampling bias, and you may want to sense check that the
recorded populations are de-duplicated to accomodate this reality.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># geographic centroid was pt 47</span></span>
<span><span class="va">centers</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">env_centered_id</span>, <span class="va">pop_centered_id</span>, <span class="fl">47</span><span class="op">)</span>, <span class="op">]</span> </span>
<span><span class="va">centers</span><span class="op">$</span><span class="va">type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Environmental'</span>, <span class="st">'Population'</span>, <span class="st">'Geographic'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">map</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">df</span>, </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">lon</span>, y <span class="op">=</span> <span class="va">lat</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">centers</span>,  </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">lon</span>, y <span class="op">=</span> <span class="va">lat</span><span class="op">)</span>,</span>
<span>    col <span class="op">=</span> <span class="st">'#FF1493'</span>, size <span class="op">=</span> <span class="fl">4</span></span>
<span>    <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu"><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html" class="external-link">geom_label_repel</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">centers</span>, </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">type</span>, x <span class="op">=</span> <span class="va">lon</span>, y <span class="op">=</span> <span class="va">lat</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">'Possbilities for centers'</span><span class="op">)</span></span></code></pre></div>
<p><img src="RareSpecies_files/figure-html/plot%20alternative%20centroids-1.png" class="r-plt" alt="" width="700"></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">env_centered_id</span>, <span class="va">env_centered</span>, <span class="va">pop_centered_id</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Reed Benkendorf.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
