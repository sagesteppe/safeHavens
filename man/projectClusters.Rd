% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/PredictiveProvenance.R
\name{projectClusters}
\alias{projectClusters}
\title{Project current environmental clusters onto a future climate scenario}
\usage{
projectClusters(
  eSDM_object,
  current_clusters,
  future_predictors,
  current_predictors,
  planar_proj,
  coord_wt = 0.001,
  mess_threshold = 0,
  cluster_novel = TRUE,
  n_novel_pts = 500,
  n_sample_per_cluster = 50,
  nbclust_args = list(),
  thresh_metric = "sensitivity",
  thresholds
)
}
\arguments{
\item{eSDM_object}{output from \code{elasticSDM()}.}

\item{current_clusters}{Output list from \code{EnvironmentalBasedSample()}.}

\item{future_predictors}{SpatRaster of future climate.
Layer names must match those retained in \code{current_model}.}

\item{current_predictors}{SpatRaster of current climate (used for MESS reference and for \code{rescaleFuture} standardisation).}

\item{planar_proj}{EPSG code or proj4 string for a planar projection in metres (same as used in the current analysis).}

\item{coord_wt}{Numeric, default \code{0.001}. Coordinate weighting passed to \code{add_weighted_coordinates}.}

\item{mess_threshold}{MESS values below this are treated as novel climate. Default \code{0}.}

\item{cluster_novel}{Boolean, defualt \code{TRUE}. If \code{TRUE} and novel cells exist, cluster them independently with NbClust.
If \code{FALSE} novel cells are left as \code{NA}.}

\item{n_novel_pts}{Numeric, default 500. Number of points to sample from novel areas for clustering.}

\item{n_sample_per_cluster}{Number of points to sample from each cluster
(existing \emph{and} novel) for the relationship tree.  Default \code{50}.}

\item{nbclust_args}{Named list of arguments forwarded to \code{NbClust::NbClust}.
Sensible defaults are set internally (\code{min.nc = 2}, \code{max.nc = 10}, \code{method = "ward.D2"}, \code{index = "all"}).}

\item{thresh_metric}{Character. Default 'sensitivity', dismo::threshold to use for cutting the future sdm into a binary surface.}

\item{thresholds}{current era thresholds from \code{postProcessSDM}}
}
\value{
A named list:
\item{clusters_sf}{\code{sf} polygons with column \code{ID}.}
\item{suitable_habitat}{Raster of masked suitable habitat under future conditions}
\item{novel_mask}{\code{SpatRaster} — logical, \code{TRUE} where MESS < threshold.}
\item{mess}{\code{SpatRaster} — raw MESS scores (minimum across all variables).}
\item{changes}{\code{data.frame} — per-cluster area and centroid-shift metrics.}
\item{novel_similarity}{\code{data.frame} — nearest existing cluster and mean
silhouette width for each novel cluster.  Zero-row data frame if none.}
}
\description{
Main entry point for the future-projection workflow.  The steps are:
}
\details{
\enumerate{
\item Rescale future predictors with current betas (\code{rescaleFuture}).
\item Run \code{dismo::mess} to identify novel climate cells.
\item Predict known-climate cells with the existing KNN classifier.
\item If novel cells exist and \code{cluster_novel = TRUE}, cluster them
independently with \code{NbClust} (\code{cluster_novel_areas}).
\item Sample points from every cluster (existing + novel), force them onto a
single tree, and extract nearest-existing-cluster relationships via
silhouette (\code{analyze_cluster_relationships}).
\item Polygonise and calculate area / centroid changes.
}
}
