# safeHavens

The goal of this package is to provide germplasm curators with easily
referable spatial data sets to help prioritize field collection efforts.

## Overview

It provides functionality for seven sampling schemes which various
curators are interested in, many of which are likely to outperform
others for certain species or areas. The package also creates species
distribution models, but with the goal of germplasm sampling, rather
than predicting ranges at fine resolutions, or making inference; if you
are interested in this functionality R has several dozen other packages
which are tailored for these purposes.

## Description

This package helps germplasm curators communicate areas of interest to
collection teams for them to collect new material for accession. It
provides seven different sampling approaches for curators to choose from
for each individual taxon they hope to process.

## Installation

`safeHavens` is available only on github. It can be installed using
`remotes` or `devtools` like so:

``` R
install.packages('devtools')
devtools::install_github('sagesteppe/safeHavens')

install.packages('remotes') # remotes is very similar and  a good alternativ for this use case.
remotes::install_github('sagesteppe/safeHavens')
```

Once installed it can be attached for use like any other package from
github or CRAN

``` R
library(safeHavens)
```

## Usage

`safeHavens` has only seven user facing functions for generating the
sampling schemes.

### Available Sampling Schemes

The following table shows the eight sampling approaches available in
safeHavens, with their computational complexity (Comp.) and
environmental data requirements (Envi.): L = Low, M = Medium, H = High.

| Function                   | Description                             | Comp. | Envi. |
|----------------------------|-----------------------------------------|-------|-------|
| `PointBasedSample`         | Creates points to make pieces over area | L     | L     |
| `EqualAreaSample`          | Breaks area into similar size pieces    | L     | L     |
| `OpportunisticSample`      | Using PBS with existing records         | L     | L     |
| `KMedoidsBasedSample`      | Use ecoregions or STSz for sample       | L     | M     |
| `IBDBasedSample`           | Breaks species range into clusters      | H     | M     |
| `PolygonBasedSample`       | Using existing ecoregions to sample     | L     | H     |
| `EnvironmentalBasedSample` | Uses correlations from SDM to sample    | H     | H     |

The species distribution modelling section has a couple functions which
are essential for achieving the `EnvironmentalBasedSample` design, these
are: `elasticSDM`, `PostProcessSDM`, `RescaleRasters` and
`writeSDMresults`.

## Acknowledgements

Edzer Pebesma, and Krzysztof Dyba for help with seamless installations
on Ubuntu, and getting the pkgdown website running.

# Package index

## Sampling

User facing functions for implementing the sampling schemes

- [`PointBasedSample()`](https://sagesteppe.github.io/safeHavens/reference/PointBasedSample.md)
  : Generate a sampling grid based off of regularly sampled points
  across the species range.
- [`EqualAreaSample()`](https://sagesteppe.github.io/safeHavens/reference/EqualAreaSample.md)
  : Create equal area polygons over a geographic range
- [`OpportunisticSample()`](https://sagesteppe.github.io/safeHavens/reference/OpportunisticSample.md)
  : Design additional collections around already existing collections
- [`KMedoidsBasedSample()`](https://sagesteppe.github.io/safeHavens/reference/KMedoidsBasedSample.md)
  : K Medoids Based Sample Site Selection Select a subset of sites that
  maximize spatial dispersion of sites using k-medioids clustering.
- [`IBDBasedSample()`](https://sagesteppe.github.io/safeHavens/reference/IBDBasedSample.md)
  : Sample a species based on Isolation by Geographic Distance (IBD)
- [`PolygonBasedSample()`](https://sagesteppe.github.io/safeHavens/reference/PolygonBasedSample.md)
  : Sample spatial zones within a species range
- [`EnvironmentalBasedSample()`](https://sagesteppe.github.io/safeHavens/reference/EnvironmentalBasedSample.md)
  : Create environmental and spatial clusters for targeting collection
  areas
- [`PrioritizeSample()`](https://sagesteppe.github.io/safeHavens/reference/PrioritizeSample.md)
  : Determine which areas in a sample unit should be prioritized

## Isolation by Resistance Sampling Prep

Preparation for Isolation by Resistance Sampling

- [`buildResistanceSurface()`](https://sagesteppe.github.io/safeHavens/reference/buildResistanceSurface.md)
  : Create a simple, theoretical, raster surface modelling Isolation by
  Distance.
- [`populationResistance()`](https://sagesteppe.github.io/safeHavens/reference/populationResistance.md)
  : Identify clusters of populations least separated by landscape
  resistance
- [`IBRSurface()`](https://sagesteppe.github.io/safeHavens/reference/IBRSurface.md)
  : Sample a species based on Isolation by Resistance Distance (IBR)

## Environmental Sampling Prep

Preparation for Environmental Based Sampling

- [`elasticSDM()`](https://sagesteppe.github.io/safeHavens/reference/elasticSDM.md)
  : Create a quick SDM using elastic net regression

- [`PostProcessSDM()`](https://sagesteppe.github.io/safeHavens/reference/PostProcessSDM.md)
  : Modify the output rasters from the SDM process to better match
  target goals

- [`RescaleRasters()`](https://sagesteppe.github.io/safeHavens/reference/RescaleRasters.md)
  : Rescale a raster stack to reflect the beta coefficients from a
  glmnet model

- [`writeSDMresults()`](https://sagesteppe.github.io/safeHavens/reference/writeSDMresults.md)
  :

  Save the results of SDMs from the `elasticSDM`, `RescaleRasters` and
  `PostProcessSDM` function in safeHavens

## Predictive Provenance Prep

Preparation for Predictive Provenance

- [`rescaleFuture()`](https://sagesteppe.github.io/safeHavens/reference/rescaleFuture.md)
  : Rescale future climate predictors using current model coefficients
- [`projectClusters()`](https://sagesteppe.github.io/safeHavens/reference/projectClusters.md)
  : Project current environmental clusters onto a future climate
  scenario

## Rare Plant Sampling

Optimization based site selection helpers for known populations

- [`greatCircleDistance()`](https://sagesteppe.github.io/safeHavens/reference/greatCircleDistance.md)
  : Haversine Distance Calculation
- [`split_cols()`](https://sagesteppe.github.io/safeHavens/reference/split_cols.md)
  : split and extract the temperature values from Tmin and AHM columns

# Articles

### About the package and getting started

Background, installation, usage, and sampling schemas

- [About](https://sagesteppe.github.io/safeHavens/articles/About.md):

  An overview of the package.

- [Getting
  Started](https://sagesteppe.github.io/safeHavens/articles/GettingStarted.md):

  Running the main sampling schemes for common species.

- [Isolation By
  Resistance](https://sagesteppe.github.io/safeHavens/articles/IsolationByResistance.md):

  Cleaning and prepping data for creating resistance surfaces required
  for Isolation By Resistance sampling.

- [Species Distribution
  Models](https://sagesteppe.github.io/safeHavens/articles/SpeciesDistributionModels.md):

  Creating and understanding the Species Distribution Model required for
  EnvironmentalBasedSample.

- [Predictive
  Provenance](https://sagesteppe.github.io/safeHavens/articles/PredictiveProvenance.md):

  Predictive Provenancing using Species Distribution Models.

- [Polygon Based
  Sampling](https://sagesteppe.github.io/safeHavens/articles/PolygonBasedSamples.md):

  Sampling provisional seed transfer zones and ecoregions

- [Worked
  Example](https://sagesteppe.github.io/safeHavens/articles/WorkedExample.md):

  Downloading species occurrence data, creating hulls, sampling and
  writing out data for sample design.

### Sampling schema for rare species

A supplemental schema for rare species

- [Rare Species Sampling
  Schema](https://sagesteppe.github.io/safeHavens/articles/RareSpecies.md):

  Running an additional sampling scheme for rare species.
